## **クリップボード履歴ツール仕様書**

### **1. 概要**

クリップボードの履歴を管理し、過去にコピーしたテキストや画像を簡単に再利用できるようにするデスクトップアプリケーション。PythonのTkinterライブラリを使用してGUIを構築する。

### **2. 開発環境**

  * **言語**: Python 3.x
  * **GUIライブラリ**: Tkinter (Python標準ライブラリ)
  * **外部ライブラリ**:
      * **`Pillow`**: 画像の表示と操作 (将来的な機能拡張用)
      * **`psutil`**: プロセス情報の取得
      * **`pywin32`**: Windows APIへのアクセス
      * **`keyboard`**: グローバルホットキーの監視 (将来的な機能拡張用)

**インストール**:

```bash
pip install -r requirements.txt
```

### **3. 主な機能**

#### **3.1. 履歴の管理**
*   **リスト表示**: コピーしたテキストの履歴を一覧で表示する。
*   **検索**: 履歴の中からキーワードで目的の項目を検索できる。
*   **ピン留め**: よく使う項目をリストの先頭に固定表示する。
*   **削除**: 不要な履歴を個別に、または一括で削除する。
*   **複数選択と結合コピー**: 複数のテキスト履歴を選択し、それらを連結して一度にコピーする。

#### **3.2. 定型文**
*   **登録と管理**: 頻繁に使用するテキスト（メールアドレス、挨拶文など）を登録・編集・削除できる。
*   **コピー**: 登録した定型文を簡単にクリップボードにコピーできる。

#### **3.3. 設定**
*   **テーマ設定**: ライトモードとダークモードの切り替え機能。
*   **常駐とスタートアップ**: PC起動時に自動でツールが起動する。
*   **除外設定**: パスワード管理ソフトなど、履歴を残したくないアプリケーションを指定できる。
*   **履歴の最大保存数**: 履歴を保存する最大件数を設定できる。
*   **常に手前に表示**: ウィンドウを常に最前面に表示する。

### **4. 今後の拡張機能案**

#### **4.1. 履歴の管理**
*   **画像履歴のサポート**: テキストだけでなく、コピーした画像の履歴も保存・表示できるようにする。リストには画像のサムネイルを表示し、クリックでプレビューできるようにする。
*   **書式なし貼り付け**: 書式情報（太字、色など）を取り除き、プレーンテキストとして貼り付ける機能を追加する。

#### **4.2. 検索機能**
*   **高度な検索**: 現在の単純なキーワード検索に加え、正規表現を使った高度な検索や、期間を指定しての検索ができるようにする。
*   **検索モード設定**: 設定画面で、デフォルトの検索モード（単純/正規表現）を選択できるようにする。

#### **4.3. データ管理**
*   **データベースの導入**: 現在のリストによる履歴管理から、SQLiteなどの軽量なデータベースに移行する。これにより、アプリケーションのパフォーマンスが向上し、より多くの履歴を安定して保存できるようになります。設定画面で、データベースファイルの保存場所を指定できるようにします。

#### **4.4. UI/UXの改善**
*   **モダンなデザイン**: `ttkthemes`などのライブラリを導入し、よりモダンで洗練されたデザインのUIに刷新する。
*   **ドラッグ＆ドロップ**: ドラッグ＆ドロップで履歴の順番を入れ替えられるようにする。

#### **4.5. 拡張性**
*   **プラグイン機能の基盤作り**: 将来的なプラグインアーキテクチャの基礎を構築します。例えば、コピーしたテキストを自動で整形する（例: JSONの整形、大文字/小文字の変換など）といった簡単なプラグインを実装し、そのON/OFFを設定画面で管理できるようにします。
